/*! For detailed credits and licence information see https://github.com/financial-times/polyfill-library */
(function(e){function t(e,t){var n=arguments.length>2?arguments[2]:[];if(!1===o(e))throw new TypeError(Object.prototype.toString.call(e)+"is not a function.");return e.apply(t,n)}function n(e,t){return e[t]}function r(e,t){return t in e}function o(e){return"function"==typeof e}function i(e){var t=function(e){var t=Number(e);return isNaN(t)?0:1/t==1/0||1/t==-1/0||t===1/0||t===-1/0?t:(t<0?-1:1)*Math.floor(Math.abs(t))}(e);return t<=0?0:Math.min(t,Math.pow(2,53)-1)}function s(t){if(null===t||t===e)throw TypeError();return Object(t)}function a(t,n){var r,i=(r=n,s(t)[r]);if(null===i||i===e)return e;if(!1===o(i))throw new TypeError("Method not callable: "+n);return i}function u(e){switch(typeof e){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";case"symbol":return"symbol";default:return null===e?"null":"Symbol"in this&&e instanceof this.Symbol?"symbol":"object"}}function c(r){var i=arguments.length>1?arguments[1]:e;if("object"===u(r)){if(arguments.length<2)var s="default";else i===String?s="string":i===Number&&(s="number");var c="function"==typeof this.Symbol&&"symbol"==typeof this.Symbol.toPrimitive?a(r,this.Symbol.toPrimitive):e;if(c!==e){var l=t(c,r,[s]);if("object"!==u(l))return l;throw new TypeError("Cannot convert exotic object to primitive.")}return"default"===s&&(s="number"),function(e,r){if("string"===r)var i=["toString","valueOf"];else i=["valueOf","toString"];for(var s=0;s<i.length;++s){var a=n(e,i[s]);if(o(a)){var c=t(a,e);if("object"!==u(c))return c}}throw new TypeError("Cannot convert to primitive.")}(r,s)}return r}function l(e){switch(u(e)){case"symbol":throw new TypeError("Cannot convert a Symbol value to a string");case"object":return l(c(e,"string"));default:return String(e)}}var f,p,d;function h(e,t,n){var r={value:n,writable:!0,enumerable:!1,configurable:!0};Object.defineProperty(e,t,r)}if("document"in this||"undefined"==typeof WorkerGlobalScope&&"function"!=typeof importScripts&&(this.HTMLDocument?this.Document=this.HTMLDocument:(this.Document=this.HTMLDocument=document.constructor=new Function("return function Document() {}")(),this.Document.prototype=document)),"Element"in this&&"HTMLElement"in this||function(){if(!window.Element||window.HTMLElement){window.Element=window.HTMLElement=new Function("return function Element() {}")();var e,t=document.appendChild(document.createElement("body")),n=t.appendChild(document.createElement("iframe")).contentWindow.document,r=Element.prototype=n.appendChild(n.createElement("*")),o={},i=function(e,t){var n,r,s,a=e.childNodes||[],u=-1;if(1===e.nodeType&&e.constructor!==Element)for(n in e.constructor=Element,o)r=o[n],e[n]=r;for(;s=t&&a[++u];)i(s,t);return e},s=document.getElementsByTagName("*"),a=document.createElement,u=100;r.attachEvent("onpropertychange",function(e){for(var t,n=e.propertyName,i=!o.hasOwnProperty(n),a=r[n],u=o[n],c=-1;t=s[++c];)1===t.nodeType&&(i||t[n]===u)&&(t[n]=a);o[n]=a}),r.constructor=Element,r.hasAttribute||(r.hasAttribute=function(e){return null!==this.getAttribute(e)}),c()||(document.onreadystatechange=c,e=setInterval(c,25)),document.createElement=function(e){var t=a(String(e).toLowerCase());return i(t)},document.removeChild(t)}else window.HTMLElement=window.Element;function c(){return u--||clearTimeout(e),!(!document.body||document.body.prototype||!/(complete|interactive)/.test(document.readyState))&&(i(document,!0),e&&document.body.prototype&&clearTimeout(e),!!document.body.prototype)}}(),"defineProperty"in Object&&function(){try{return Object.defineProperty({},"test",{value:42}),!0}catch(e){return!1}}()||(f=Object.defineProperty,p=Object.prototype.hasOwnProperty("__defineGetter__"),d="A property cannot both have accessors and be writable or have a value",Object.defineProperty=function(e,t,n){if(f&&(e===window||e===document||e===Element.prototype||e instanceof Element))return f(e,t,n);if(null===e||!(e instanceof Object||"object"==typeof e))throw new TypeError("Object.defineProperty called on non-object");if(!(n instanceof Object))throw new TypeError("Property description must be an object");var r=String(t),o="value"in n||"writable"in n,i="get"in n&&typeof n.get,s="set"in n&&typeof n.set;if(i){if("function"!==i)throw new TypeError("Getter must be a function");if(!p)throw new TypeError("Getters & setters cannot be defined on this javascript engine");if(o)throw new TypeError(d);Object.__defineGetter__.call(e,r,n.get)}else e[r]=n.value;if(s){if("function"!==s)throw new TypeError("Setter must be a function");if(!p)throw new TypeError("Getters & setters cannot be defined on this javascript engine");if(o)throw new TypeError(d);Object.__defineSetter__.call(e,r,n.set)}return"value"in n&&(e[r]=n.value),e}),"forEach"in Array.prototype||h(Array.prototype,"forEach",function(a){var u=s(this),c=u instanceof String?u.split(""):u,f=i(n(u,"length"));if(!1===o(a))throw new TypeError(a+" is not a function");for(var p=arguments.length>1?arguments[1]:e,d=0;d<f;){var h=l(d);if(r(c,h))t(a,p,[n(c,h),d,u]);d+=1}return e}),!("getOwnPropertyNames"in Object)){var y={}.toString,b="".split;h(Object,"getOwnPropertyNames",function(e){var t,n=[],r=["length","name","arguments","caller","prototype","observe","unobserve"];if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(t in e="[object String]"==y.call(e)?b.call(e,""):Object(e))Object.prototype.hasOwnProperty.call(e,t)&&n.push(t);for(var o=0,i=r.length;o<i;o++)r[o]in e&&n.push(r[o]);return n})}"Window"in this||"undefined"==typeof WorkerGlobalScope&&"function"!=typeof importScripts&&function(e){e.constructor?e.Window=e.constructor:(e.Window=e.constructor=new Function("return function Window() {}")()).prototype=this}(this),function(e){if(!("Event"in e))return!1;if("function"==typeof e.Event)return!0;try{return new Event("click"),!0}catch(e){return!1}}(this)||function(){var t={click:1,dblclick:1,keyup:1,keypress:1,keydown:1,mousedown:1,mouseup:1,mousemove:1,mouseover:1,mouseenter:1,mouseleave:1,mouseout:1,storage:1,storagecommit:1,textinput:1};if("undefined"!=typeof document&&"undefined"!=typeof window){var n=window.Event&&window.Event.prototype||null;o.NONE=0,o.CAPTURING_PHASE=1,o.AT_TARGET=2,o.BUBBLING_PHASE=3,window.Event=Window.prototype.Event=o,n&&Object.defineProperty(window.Event,"prototype",{configurable:!1,enumerable:!1,writable:!0,value:n}),"createEvent"in document||(window.addEventListener=Window.prototype.addEventListener=Document.prototype.addEventListener=Element.prototype.addEventListener=function(){var e=this,n=arguments[0],o=arguments[1];if(e===window&&n in t)throw new Error("In IE8 the event: "+n+" is not available on the window object. Please see https://github.com/Financial-Times/polyfill-service/issues/317 for more information.");e._events||(e._events={}),e._events[n]||(e._events[n]=function(t){var n,o=e._events[t.type].list,i=o.slice(),s=-1,a=i.length;for(t.preventDefault=function(){!1!==t.cancelable&&(t.returnValue=!1)},t.stopPropagation=function(){t.cancelBubble=!0},t.stopImmediatePropagation=function(){t.cancelBubble=!0,t.cancelImmediate=!0},t.currentTarget=e,t.relatedTarget=t.fromElement||null,t.target=t.target||t.srcElement||e,t.timeStamp=(new Date).getTime(),t.clientX&&(t.pageX=t.clientX+document.documentElement.scrollLeft,t.pageY=t.clientY+document.documentElement.scrollTop);++s<a&&!t.cancelImmediate;)s in i&&-1!==r(o,n=i[s])&&"function"==typeof n&&n.call(e,t)},e._events[n].list=[],e.attachEvent&&e.attachEvent("on"+n,e._events[n])),e._events[n].list.push(o)},window.removeEventListener=Window.prototype.removeEventListener=Document.prototype.removeEventListener=Element.prototype.removeEventListener=function(){var e,t=arguments[0],n=arguments[1];this._events&&this._events[t]&&this._events[t].list&&-1!==(e=r(this._events[t].list,n))&&(this._events[t].list.splice(e,1),this._events[t].list.length||(this.detachEvent&&this.detachEvent("on"+t,this._events[t]),delete this._events[t]))},window.dispatchEvent=Window.prototype.dispatchEvent=Document.prototype.dispatchEvent=Element.prototype.dispatchEvent=function(e){if(!arguments.length)throw new Error("Not enough arguments");if(!e||"string"!=typeof e.type)throw new Error("DOM Events Exception 0");var t=this,n=e.type;try{if(!e.bubbles){e.cancelBubble=!0;var r=function(e){e.cancelBubble=!0,(t||window).detachEvent("on"+n,r)};this.attachEvent("on"+n,r)}this.fireEvent("on"+n,e)}catch(r){e.target=t;do{e.currentTarget=t,"_events"in t&&"function"==typeof t._events[n]&&t._events[n].call(t,e),"function"==typeof t["on"+n]&&t["on"+n].call(t,e),t=9===t.nodeType?t.parentWindow:t.parentNode}while(t&&!e.cancelBubble)}return!0},document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&document.dispatchEvent(new o("DOMContentLoaded",{bubbles:!0}))}))}function r(e,t){for(var n=-1,r=e.length;++n<r;)if(n in e&&e[n]===t)return n;return-1}function o(t,n){if(!t)throw new Error("Not enough arguments");var r;if("createEvent"in document){r=document.createEvent("Event");var o=!(!n||n.bubbles===e)&&n.bubbles,i=!(!n||n.cancelable===e)&&n.cancelable;return r.initEvent(t,o,i),r}return(r=document.createEventObject()).type=t,r.bubbles=!(!n||n.bubbles===e)&&n.bubbles,r.cancelable=!(!n||n.cancelable===e)&&n.cancelable,r}}(),"XMLHttpRequest"in this&&"prototype"in this.XMLHttpRequest&&"addEventListener"in this.XMLHttpRequest.prototype||function(e,t){e.XMLHttpRequest=function(){var e=this,n=e._request=t?new t:new ActiveXObject("MSXML2.XMLHTTP.3.0");n.onreadystatechange=function(){e.readyState=n.readyState;var t=4===e.readyState;e.response=e.responseText=t?n.responseText:null,e.status=t?n.status:null,e.statusText=t?n.statusText:null,e.dispatchEvent(new Event("readystatechange")),t&&e.dispatchEvent(new Event("load"))},"onerror"in n&&(n.onerror=function(){e.dispatchEvent(new Event("error"))})},e.XMLHttpRequest.UNSENT=0,e.XMLHttpRequest.OPENED=1,e.XMLHttpRequest.HEADERS_RECEIVED=2,e.XMLHttpRequest.LOADING=3,e.XMLHttpRequest.DONE=4;var n=e.XMLHttpRequest.prototype;n.addEventListener=e.addEventListener,n.removeEventListener=e.removeEventListener,n.dispatchEvent=e.dispatchEvent,n.abort=function(){return this._request()},n.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()},n.getResponseHeader=function(e){return this._request.getResponseHeader(e)},n.open=function(e,t){this._request.open(e,t,arguments[2],arguments[3],arguments[4])},n.overrideMimeType=function(e){this._request.overrideMimeType(e)},n.send=function(){this._request.send(0 in arguments?arguments[0]:null)},n.setRequestHeader=function(e,t){this._request.setRequestHeader(e,t)}}(this,this.XMLHttpRequest),"fetch"in this||function(t){"use strict";var n={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(n.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&r.indexOf(Object.prototype.toString.call(e))>-1};function s(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function a(e){return"string"!=typeof e&&(e=String(e)),e}function u(t){var r={next:function(){var n=t.shift();return{done:n===e,value:n}}};return n.iterable&&(r[Symbol.iterator]=function(){return r}),r}function c(e){this.map={},e instanceof c?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function p(e){var t=new FileReader,n=f(t);return t.readAsArrayBuffer(e),n}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(n.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(n.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(n.arrayBuffer&&n.blob&&o(e))this._bodyArrayBuffer=d(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!n.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var e,t,n,r=l(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=f(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}c.prototype.append=function(e,t){e=s(e),t=a(t);var n=this.map[e];this.map[e]=n?n+","+t:t},c.prototype.delete=function(e){delete this.map[s(e)]},c.prototype.get=function(e){return e=s(e),this.has(e)?this.map[e]:null},c.prototype.has=function(e){return this.map.hasOwnProperty(s(e))},c.prototype.set=function(e,t){this.map[s(e)]=a(t)},c.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},c.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),u(e)},c.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),u(e)},c.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),u(e)},n.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var n,r,o=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new c(e.headers)),this.method=e.method,this.mode=e.mode,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new c(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),y.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function m(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(o))}}),t}function v(t,n){n||(n={}),this.type="default",this.status=n.status===e?200:n.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in n?n.statusText:"OK",this.headers=new c(n.headers),this.url=n.url||"",this._initBody(t)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},h.call(b.prototype),h.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var w=[301,302,303,307,308];v.redirect=function(e,t){if(-1===w.indexOf(t))throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})},t.Headers=c,t.Request=b,t.Response=v,t.fetch=function(e,t){return new Promise(function(r,o){var i=new b(e,t),s=new XMLHttpRequest;s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new c,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();t.append(r,o)}}),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var o="response"in s?s.response:s.responseText;r(new v(o,n))},s.onerror=function(){o(new TypeError("Network request failed"))},s.ontimeout=function(){o(new TypeError("Network request failed"))},s.open(i.method,i.url,!0),"include"===i.credentials?s.withCredentials=!0:"omit"===i.credentials&&(s.withCredentials=!1),"responseType"in s&&n.blob&&(s.responseType="blob"),i.headers.forEach(function(e,t){s.setRequestHeader(t,e)}),s.send(void 0===i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}("undefined"!=typeof self?self:this)}).call("object"==typeof window&&window||"object"==typeof self&&self||"object"==typeof global&&global||{});