!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.ps=n():t.ps=n()}(this,function(){return(this.webpackJsonp_name_=this.webpackJsonp_name_||[]).push([[11],{47:function(t,n,e){function o(){e(48)}var i=function(){return["findIndex"in Array.prototype?0:1,"values"in Object?0:1,"Promise"in this?0:1,"fetch"in this?0:1]}.call(window);if(-1===i.indexOf(1))o();else{var r=document.createElement("script");r.src="/polyfills."+i.join("")+".js",r.onload=o,r.onerror=function(t){console.error("Could not load the polyfills: "+t)},document.head.appendChild(r)}},48:function(t,n,e){var o=e(49),i=e(55),r=6e5;function a(){return Date.now()}Date.now||(Date.now=function(){return(new Date).getTime()}),String.prototype.hexEncode=function(){var t,n="";for(t=0;t<this.length;t++)n+=("000"+this.charCodeAt(t).toString(16)).slice(-4);return n},String.prototype.hexDecode=function(){var t,n=this.match(/.{1,4}/g)||[],e="";for(t=0;t<n.length;t++)e+=String.fromCharCode(parseInt(n[t],16));return e};function c(t){t||(t="thiss.io");var n=i.initNamespaceStorage(t).localStorage;return n.set("_name",t),n}function s(t){if(t.entity&&(t.entity.entity_id||t.entity.entityID)&&t.entity.title){var n=t.entity;if(n&&n.entityID&&!n.entity_id&&(n.entity_id=n.entityID),n&&!n.entity_icon&&n.icon&&(n.entity_icon=n.icon),n.domains){var e=n.domains.split(";")||[];n.domain=e[0]}}return t}function d(t,n){return t.isSet(n)?t.get(n):void 0}o.on("update",{window:window.parent},function(t){var n=t.data.entity,e=c(t.data.context),o=a(),i=n.entity_id.hexEncode(),f=d(e,i);return!function(t,n){return void 0!==t&&void 0!==t.last_refresh&&t.last_refresh+r>n}(f,o)?f={last_refresh:o,entity:n}:(f.last_refresh=o,f.entity=n),console.log(f),e.set(i,s(f)),function(t){t.keys().filter(function(t){return void 0!==t&&"_name"!==t}).map(function(n){return s(d(t,n))}).sort(function(t,n){return t.last_refresh-n.last_refresh}).slice(3).forEach(function(n){t.remove(n.entity_id.hexEncode())})}(e),f}),o.on("entities",{window:window.parent},function(t){var n=c(t.data.context),e=t.data.count;void 0===e&&(e=3);a();return console.log(n.keys()),n.keys().filter(function(t){return void 0!==t&&"_name"!==t}).map(function(t){return s(d(n,t))}).sort(function(t,n){return t.last_refresh-n.last_refresh}).slice(0,3)}),o.on("entity",{window:window.parent},function(t){var n=c(t.data.context),e=t.data.entity_id;if(!e)throw new Error("Unable to find entity_id in request");var o=d(n,e.hexEncode());return console.log(o),o}),o.on("remove",{window:window.parent},function(t){var n=c(t.data.context),e=t.data.entity_id;void 0===e||n.remove(e.hexEncode())})}},[[47,0,1,14]]])});